# v0.5.6：進階 GC（可選研究方向）

<br>

---

<br>

**目標**：研究現代 GC 演算法的設計思想

**G1 GC 概念**：

```
G1 的 Region 劃分：

┌─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┐
│  E  │  E  │  S  │  O  │  O  │  H  │  H  │  -  │
└─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┘
   E = Eden
   S = Survivor
   O = Old
   H = Humongous (大物件)
   - = 空閒

特點：
- 將 Heap 劃分為等大的 Region（1-32 MB）
- Region 可以動態充當 Eden/Survivor/Old
- Garbage First：優先回收垃圾最多的 Region
- 可預測的停頓時間
```

<br>

**ZGC / Shenandoah 概念**：

```
Colored Pointer（染色指針）：

  ┌────────────────────────────────────────────────────────┐
  │           64-bit 物件指針                              │
  ├────┬─────┬─────┬─────┬─────────────────────────────────┤
  │ 16 │  1  │  1  │  1  │            45                   │
  │bits│ bit │ bit │ bit │          bits                   │
  ├────┴─────┴─────┴─────┴─────────────────────────────────┤
  │unused│ Finalizable │ Remapped │ Marked1 │ Marked0 │地址│
  └────────────────────────────────────────────────────────┘

優點：
- 可以在不修改物件的情況下記錄 GC 狀態
- 配合 Load Barrier 實現併發壓縮
- 停頓時間可控制在 10ms 以內
```

<br>